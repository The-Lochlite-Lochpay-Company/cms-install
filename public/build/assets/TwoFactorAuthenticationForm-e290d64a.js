import{Q as L,r as v,T as M,k as H,E as N,o as t,c as p,w as o,f as u,d as a,a as r,e as n,b as l,u as b,M as Q,F as Y,g as D,t as P,n as x,q as S}from"./app-7485cb55.js";import z from"./ActionSection-2ba3d291.js";import y from"./ConfirmsPassword-51e7bffc.js";import G from"./DangerButton-7aeb2fe1.js";import O from"./InputError-9cb9d01f.js";import U from"./InputLabel-f7333d50.js";import A from"./PrimaryButton-bc5fb706.js";import C from"./SecondaryButton-e7d33719.js";import W from"./TextInput-699b3d1e.js";import"./SectionTitle-1e2ad9a3.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./DialogModal-d0ed3206.js";import"./Modal-ea0c2bfd.js";const j={key:0,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},I={key:1,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},J={key:2,class:"text-lg font-medium text-gray-900 dark:text-gray-100"},X={key:3},Z={key:0},ee={class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},te={key:0,class:"font-semibold"},oe={key:1},ae=["innerHTML"],se={key:0,class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},re={class:"font-semibold"},ne=["innerHTML"],le={key:1,class:"mt-4"},ie={key:1},ue={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 dark:bg-gray-900 dark:text-gray-100 rounded-lg"},ce={class:"mt-5"},de={key:0},me={key:1},Fe={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup($){const R=$,V=L(),c=v(!1),s=v(!1),d=v(!1),h=v(null),_=v(null),g=v([]),m=M({code:""}),f=H(()=>{var i;return!c.value&&((i=V.props.auth.user)==null?void 0:i.two_factor_enabled)});N(f,()=>{f.value||(m.reset(),m.clearErrors())});const B=()=>{c.value=!0,S.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([K(),q(),k()]),onFinish:()=>{c.value=!1,s.value=R.requiresConfirmation}})},K=()=>axios.get(route("two-factor.qr-code")).then(i=>{h.value=i.data.svg}),q=()=>axios.get(route("two-factor.secret-key")).then(i=>{_.value=i.data.secretKey}),k=()=>axios.get(route("two-factor.recovery-codes")).then(i=>{g.value=i.data}),T=()=>{m.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{s.value=!1,h.value=null,_.value=null}})},E=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>k())},F=()=>{d.value=!0,S.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{d.value=!1,s.value=!1}})};return(i,e)=>(t(),p(z,null,{title:o(()=>e[1]||(e[1]=[u(" Two Factor Authentication ")])),description:o(()=>e[2]||(e[2]=[u(" Add additional security to your account using two factor authentication. ")])),content:o(()=>[f.value&&!s.value?(t(),a("h3",j," You have enabled two factor authentication. ")):f.value&&s.value?(t(),a("h3",I," Finish enabling two factor authentication. ")):(t(),a("h3",J," You have not enabled two factor authentication. ")),e[11]||(e[11]=r("div",{class:"mt-3 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[r("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1)),f.value?(t(),a("div",X,[h.value?(t(),a("div",Z,[r("div",ee,[s.value?(t(),a("p",te," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(t(),a("p",oe," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),r("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:h.value},null,8,ae),_.value?(t(),a("div",se,[r("p",re,[e[3]||(e[3]=u(" Setup Key: ")),r("span",{innerHTML:_.value},null,8,ne)])])):n("",!0),s.value?(t(),a("div",le,[l(U,{for:"code",value:"Code"}),l(W,{id:"code",modelValue:b(m).code,"onUpdate:modelValue":e[0]||(e[0]=w=>b(m).code=w),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:Q(T,["enter"])},null,8,["modelValue"]),l(O,{message:b(m).errors.code,class:"mt-2"},null,8,["message"])])):n("",!0)])):n("",!0),g.value.length>0&&!s.value?(t(),a("div",ie,[e[4]||(e[4]=r("div",{class:"mt-4 max-w-xl text-sm text-gray-600 dark:text-gray-400"},[r("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1)),r("div",ue,[(t(!0),a(Y,null,D(g.value,w=>(t(),a("div",{key:w},P(w),1))),128))])])):n("",!0)])):n("",!0),r("div",ce,[f.value?(t(),a("div",me,[l(y,{onConfirmed:T},{default:o(()=>[s.value?(t(),p(A,{key:0,type:"button",class:x(["me-3",{"opacity-25":c.value}]),disabled:c.value},{default:o(()=>e[6]||(e[6]=[u(" Confirm ")])),_:1},8,["class","disabled"])):n("",!0)]),_:1}),l(y,{onConfirmed:E},{default:o(()=>[g.value.length>0&&!s.value?(t(),p(C,{key:0,class:"me-3"},{default:o(()=>e[7]||(e[7]=[u(" Regenerate Recovery Codes ")])),_:1})):n("",!0)]),_:1}),l(y,{onConfirmed:k},{default:o(()=>[g.value.length===0&&!s.value?(t(),p(C,{key:0,class:"me-3"},{default:o(()=>e[8]||(e[8]=[u(" Show Recovery Codes ")])),_:1})):n("",!0)]),_:1}),l(y,{onConfirmed:F},{default:o(()=>[s.value?(t(),p(C,{key:0,class:x({"opacity-25":d.value}),disabled:d.value},{default:o(()=>e[9]||(e[9]=[u(" Cancel ")])),_:1},8,["class","disabled"])):n("",!0)]),_:1}),l(y,{onConfirmed:F},{default:o(()=>[s.value?n("",!0):(t(),p(G,{key:0,class:x({"opacity-25":d.value}),disabled:d.value},{default:o(()=>e[10]||(e[10]=[u(" Disable ")])),_:1},8,["class","disabled"]))]),_:1})])):(t(),a("div",de,[l(y,{onConfirmed:B},{default:o(()=>[l(A,{type:"button",class:x({"opacity-25":c.value}),disabled:c.value},{default:o(()=>e[5]||(e[5]=[u(" Enable ")])),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Fe as default};
